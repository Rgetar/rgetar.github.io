<!DOCTYPE html>
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
<style type="text/css" media="Screen">
sub {font-size: 0.83rem;}
sup {font-size: 0.83rem;}
</style>
<meta charset="utf-8" />
<title>Ordinal Explorer</title>
</head>
<style type="text/css">
a{text-decoration:none;color:blue;}
a:hover{text-decoration:underline;}
a:visited{color:blue;}
li{list-style-type:none;cursor:pointer;}
td{cursor:pointer;}
body{line-height:2;}
</style>
<body style="font-family:Arial;white-space:pre;"
><div id="xs" style="position:fixed;border:1px solid #cccccc;border-radius:5px;padding:5px 15px 5px 15px;";
hidden="true";></div><ul id="list"
><li id="-"></li><li id="Limit">Limit</li></ul><hr><div id="counter"
>Total 1 ordinal</div>

<div align="center" onmousedown="return false"><i>Toggle collapse and expansion levels:</i>
<table id="exptable" border="5" cellspacing="0" cellpadding="0">
<tr>
<td id="etc"> collapse </td>
<td id="et0">    small    </td>
<td id="et1" style="background:#b0ffb0;font-size:33px;">   1   </td>
<td id="et2" style="font-size:33px;">   2   </td>
<td id="et3" style="font-size:33px;">   3   </td>
<td id="et4" style="font-size:33px;">   4   </td>
<td id="et5" style="font-size:33px;">   5   </td>
<td id="et6" style="font-size:33px;">   6   </td>
<td id="et7" style="font-size:33px;">   7   </td>
<td id="et8" style="font-size:33px;">   8   </td>
<td id="et9" style="font-size:33px;">   9   </td>
</tr>
</table></div>

<div align="center" onmousedown="return false"><i>Extra fundamental sequence elements:</i>
<table cellspacing="0" cellpadding="0">
<tr>
<td id="decef" style="color:#eeeeee;font-size:50px;cursor:default;">◅ </td>
<td id="ecfve" style="font-size:25px;cursor:default;"><table border="5" cellspacing="0" cellpadding="0">
<tr>
<td id="ecfv" style="font-size:33px;cursor:default;">   0   </td>
</tr>
</table></td>
<td id="incef" style="font-size:50px;"> ▻</td>
</tr>
</table></div>

<div align="center" onmousedown="return false"><i>Text near mouse cursor:</i>
<table border="5" cellspacing="0" cellpadding="0">
<tr>
<td id="vtext" style="background:#b0ffb0;font-size:25px;">    <big><big><big>✓</big></big></big>    </td>
</tr>
</table></div>


<script
>'use strict'
// get position of last symbol p of string st (if l=true then first)
function getls(st,p,l=false){
let e=l?-1:st.length;
let np=0;
while(((!l&&e>-1)||(l&&e<st.length))&&(np!=0||st[e]!=p)){
   l?e++:e--;
   if (st[e]=='['||st[e]=='(') np--;
   else if (st[e]==']'||st[e]==')') np++;}
return e;}

// create [booster]base string
function bb(booster,base){
return '['+booster+']'+base;}

// get base of string st
function base(st){
return st.slice(getls(st,']',true)+1);}

// get booster of string st
function booster(st){
return st.slice(1,getls(st,']',true));}

// get successor of ordinal st
function suc(st){
return '[]'+st;}

// get predecessor of successor ordinal st = X + 1
function pred(st){
return st.slice(2);}

// finite ordinal string st to number
function fostn(st){
return st.length/2;}

// finite ordinal e from integer to computer format
function cf(e){
let s='';
for(let i=0;i<e;i++) 
   s=suc(s)
return s;}

// compare expressions st1, st2 (if st1<st2 then -1; if st1=st2 then 0; if st1>st2 then 1)
function compare(st1,st2){
return st1==st2?0:[...st1].reverse()>[...st2].reverse()?1:-1}

// delete all boosters of b < b, add a booster
function bbc(a,b){
while(b!=''&&b!=col&&compare(a,booster(b))==1)
   b=base(b);
return bb(a,b);}

function rest(l,st){
return compare(l,st)==1?st:rest(l,booster(st));}

function ceill(l,st){
return compare(l,st)==1?l:bbc(ceill(l,booster(st)),st);}

function ledge(st){
let x=booster(st);
return compare(col,x)==1?col:bbc(ceill(col,x),base(st));}

function cascade(x,c,st){
let y=booster(c);
let d=cof(y);
let s=d==col||d==ledge(c)?bb(fs(y,rest(d,x)),base(c)):cascade(y,d,c);
return bb(fs(x,s),base(st));}

// get cofinality of ordinal st
function cof(st){
if(st==bo)                         // L
   return '[[]]';
else if (st==''||st==col)            // 1, 6
   return st;
else{
   let x=booster(st);
   if(x=='')                       // 2
      return '[]';
   else{
      let c=cof(x);
      if(c=='[]')                // 3
         return '[[]]';
      else if(compare(st,c)==1)       // > C
         return c;
      else{
         let l=ledge(st);
         if(compare(l,c)<1)
            return st;                    // 7
         else{
            let ca=compare(bbc(ceill(l,x),base(st)),c);
            if(ca==1)   // 4, 5, 8
               return c;
            else if(ca==0)
               return '[[]]';   
            else 
               return cof(cascade(x,c,st));
            }
         }
      }
   }
}

// get n-th element of fs of ordinal st
function fs(st,n){
if(st==bo){
   let s=col;
   for(let i=0;i<fostn(n);i++)
      s=bb(s,col);
   for(let i=0;i<2;i++)
      s=bb(s,'');
   return s;}
else if(st==''||st==col)     // 1, 6
   return n;
else{
   let x=booster(st);
   let beta=base(st);
   if(x=='')                         // 2
      return beta;
   else{
      let c=cof(x);
      if(c=='[]'){                    // 3
         let s=beta;
         x=pred(x);
         for(let i=0;i<fostn(n);i++)
            s=bb(x,s);
         return s;}
      else if(compare(st,c)==1)     // > C
         return bb(fs(x,n),beta);
      else{
         let l=ledge(st);
         if(compare(l,c)<1)       // 7
            return n;
         else{
            let ca=compare(bbc(ceill(l,x),base(st)),c);
            if(ca==1)                   // 4, 5, 8
               return bb(fs(x,n),beta);
            else if(ca==0){              // 9
               let s=beta;
               for(let i=0;i<fostn(n);i++)
                  s=bb(fs(x,s),beta);
               return s;}
            else
               return fs(cascade(x,c,st),n);
            }
         }
      }
   }
}

function rx(s,c,n,q){
count++;
let x=document.createElement('li');
x.id=s;
x.innerHTML=s;
if(s==''||s.slice(0,2)=='[]')
   x.style.cursor='default';
x=x.outerHTML;
if(q>0){
	let y=document.createElement('ul');
   s=fs(c,n);
   n=suc(n);
   y.innerHTML=rx(s,c,n,q-1);
   x+=y.outerHTML;} 
return x;     
}

// small expansion of pair c > l
function se(c,l,q){
let n='';
let s;
do{
   s=fs(c,n);
   n=suc(n);}
while(l!='-'&&compare(s,l)<1)
return q==-1?s:rx(s,c,n,q);  	
}

function pl(c){
let e=0;
let l=c.previousSibling;
if(l==null){
   e++;
   l=c.parentNode.previousSibling;}  
while(l.tagName!='LI'){
   e--;
   l=l.lastChild;}
return [l,e];}

function cl(c){
while(c.lastChild.tagName=='UL')
    c=c.lastChild;
return c;}

function countli(c){
let n=0;
for(let l=c.firstChild;l!=null;l=l.nextSibling)
   if(l.tagName=='UL')
      n+=countli(l);
   else  
      n++;
return n;      
}

document.onmousemove=function(e){
   xs.style.left=e.clientX+50+'px';
   xs.style.top=e.clientY-10+'px';  
}

document.onmouseover=function(e){
if(vt){
let c=e.target;
let h;
if(c.id=='vtext'||c.tagName=='BIG'){
h='<b>Hide</b> text near mouse cursor';
xs.style.background='#f0fff0';
}
else if(c.id=='decef'){
if(efs>0){
h='<b>Remove</b> extra fs element';
xs.style.background='#f0fff0';}
else
   h='<i>Remove extra fs element</i>';	
}
else if(c.id=='incef'){
h='<b>Add</b> extra fs element';
xs.style.background='#f0fff0';
}
else if(c.tagName=='TD'&&c.id!='ecfv'&&c.id!='ecfve'){
   h='toggle <b>'+(c.id=='etc'?'collapse':exp[c.id[2]]+' expansion')+'</b>';
   xs.style.background='#f0fff0';}
else{
   h=exp[eo];
   xs.style.background='#fff';
   h+=eo<0?'':' expansion'+(efs==0?'':' with '+efs+' extra fs element'+(efs==1?'':'s'));
   if(c.tagName=='LI'){
      let q=c.previousSibling;    
      if(c.id!=''&&c.id.slice(0,2)!='[]'&&(eo>0||(q!=null&&q.tagName=='UL'))){
         h+=' of ';
         let l=eo>0?pl(c)[0]:cl(q).previousSibling;
         if(l.id!='-')
      	   h+='pair ';
         h+=c.id;
         if(l.id!='-')
         	h+=', '+l.id;          
         h='<b>Do '+h+'</b>';
         xs.style.background='#f0fff0';}
      else 
      	h='<i>'+h+'</i>';         
      h+='<br><b>'+c.id+'</b> fundamental sequence:'; 
      if(c.id=='')
         h+='<br>'+'<i>empty</i>';
      else{
         let n='';
         let b=c.id.slice(0,2)=='[]';
      	for(let i=0;i<(b?1:6);i++){
   	      n=suc(n);
      	   h+='<li>   '+i+': '+fs(c.id,n)+'</li>';}
      	if(!b)      
   	      h+='<li>   ...</li>';   
   	   }               
      }
   else
   	h='<i>'+h+'</i>'; 
   } 
xs.hidden=false;   
xs.innerHTML=h;    
}}

document.onmouseout=function(e){
   xs.hidden=true;  
}

list.onclick=function(e){
let c=e.target;
if(c.id!='list'&&c.id!=''&&c.id.slice(0,2)!='[]'){
   if(eo<0){
   c=c.previousSibling;
   if(c!=null&&c.tagName=='UL'){  
      c=cl(c);
      count-=countli(c);   
      c.remove();}	
   }
   else{    
      let[l,i]=pl(c);
      e=(eo==0?1:eo)-i;    
      while(c!=l){
         if(c.previousSibling==null){
            if(e>=0)
               c.insertAdjacentHTML('beforebegin',se(c.id,pl(c)[0].id,e+efs));}
         else{
            let[q,i]=pl(c);
            i=e+i-1;
            if(i>=0){
               let y=document.createElement('ul');
               y.innerHTML=se(c.id,q.id,i+efs);
               q.insertAdjacentHTML('afterend',y.outerHTML);}      	
            }
         if(eo==0)
            c=l;
         else
            do{
               [c,i]=pl(c);
               e+=i;}
            while(c!=l&&(c.id==''||c.id.slice(0,2)=='[]'));
         }                           
      }
   counter.innerHTML='Total '+count+' ordinal'+(count==1?'':'s');  
   }
}

exptable.onclick=function(e){
let c=e.target;
if(c.tagName=='TD'){    
   (eo==-1?etc:etar[eo]).style.background='#fff';
   c.style.background='#b0ffb0';
   eo=c.id=='etc'?-1:c.id[2];
   }
}

vtext.onclick=function(e){
let c=e.target;
while(c.tagName!='TD')
   c=c.parentNode;
if(vt){
   c.style.background='#fff';
   c.style.color='#fff';
   vt=false;
   xs.hidden=true;
   }
else{
   c.style.background='#b0ffb0';
   c.style.color='#000';
   vt=true;
   xs.hidden=false;
   }      
}

decef.onclick=function(e){
if(efs>0){
   efs--;
   ecfv.innerHTML='   '+efs+'   ';
   if(efs==0){
      ecfv.style.background='#fff';
      decef.style.color='#eeeeee';
      decef.style.cursor='default';
      xs.style.background='#fff';
      xs.innerHTML='<i>Remove extra fs element</i>';} 	
   }      
}

incef.onclick=function(e){
efs++;
ecfv.innerHTML='   '+efs+'   ';
if(efs==1){
   decef.style.color='#000';
   decef.style.cursor='pointer';
   ecfv.style.background='#b0ffb0';
   }    
}

let bo='Limit';
let col='c';
let eo=1;
let efs=0;
let exp=['small','single','double','triple','quadruple','pentuple','sextuple','septuple','octuple','nonuple'];
exp[-1]='collapse';
let etar=[et0,et1,et2,et3,et4,et5,et6,et7,et8,et9];
let count=1;
let vt=true;
</script
></body>
</html>
